# 利用进程池实现的网盘项目开发手册

## 运行依赖

### server

需要 default.config 文件方可正确运行. 其格式如下:

第一行: 服务器 ip 地址, 格式为点分十进制.

第二行: 使用的端口号.

第三行: 子进程个数

### client

需要 default.config 文件方可正确运行. 其格式如下:

第一行: 服务器 ip 地址, 格式为点分十进制.

第二行: 使用的端口号.

第三行: 欲下载的文件名

## 传输协议

* 客户端向服务器发送想要下载的文件名称.

* 服务器向客户端发送一段确认信息, 用于告知客户端该文件的大小 (文件不存在即大小为 0).

* 服务器向客户端发送文件.

## 版本说明:

V1.0: 可以创建进程池, 且父子进程之间可以通信. (不考虑传递文件描述符的内核控制信息.)

V2.0: 可以在父子进程之间传递文件描述符.

V3.0: 实现简单的文件传输协议, 可以实现小文件的传输. (不考虑大文件传输时, 缓冲区发送和接收速度不匹配引起的崩溃; 亦不考虑在对端非正常断开时的崩溃.)

V4.0: 解决因缓冲区发送和接收速度不匹配引起的大文件传输崩溃. (改为循环传输方案)

V5.0:

* 解决在客户端断开连接时, 服务器崩溃的问题.

* 客户端增加进度条显示, 当前下载速度显示, 并在下载成功完成后显示平均下载速度.

至此, 网盘项目一期目标完成.

V6.0: 通过 mmap 方式实现文件读写, 以提高文件传输效率. (对客户端的部分代码进行了重构.)

V7.0:

* 通过 sendfile 实现文件传输, 提高文件传输效率.